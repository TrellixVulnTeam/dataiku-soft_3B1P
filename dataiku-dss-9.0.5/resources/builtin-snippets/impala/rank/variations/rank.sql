select category, id, RANK() OVER (PARTITION BY category ORDER BY sale_date asc) from table;